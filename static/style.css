* {
  box-sizing: border-box;
}
html,
body {
  margin: 0;
  padding: 0;
  height: 100%;
}

:root {
  --bg: #0e1320;
  --panel: #151a2f;
  --muted: #8f9bb3;
  --text: #e8edf7;
  --accent: #7c3aed;
  --grid-gap: 12px;
}

/* Base */
body {
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Helvetica,
    Arial, sans-serif;
  background: linear-gradient(180deg, #0b0f1e, #121735);
  color: var(--text);
  min-height: 100%;
}

/* Header minimal: solo brand + matita */
.topbar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 12px;
  padding: 10px 14px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.06);
  backdrop-filter: blur(6px);
  position: sticky;
  top: 0;
  background: rgba(10, 12, 24, 0.6);
  z-index: 5;
}
.brand h1 {
  margin: 0;
  font-size: 18px;
}
.icon-btn {
  appearance: none;
  border: 1px solid rgba(255, 255, 255, 0.14);
  background: transparent;
  color: var(--text);
  border-radius: 10px;
  padding: 8px 10px;
  cursor: pointer;
  font-weight: 700;
}

/* Pannello a scomparsa (slide-down) */
.edit-panel {
  overflow: hidden;
  max-height: 0; /* chiuso */
  transition: max-height 0.25s ease;
  border-bottom: 1px solid rgba(255, 255, 255, 0.06);
  background: linear-gradient(
    180deg,
    rgba(255, 255, 255, 0.05),
    rgba(255, 255, 255, 0.02)
  );
}
.edit-panel.open {
  max-height: 420px;
} /* altezza sufficiente per i controlli */

.panel-row {
  display: flex;
  gap: 16px;
  flex-wrap: wrap;
  padding: 14px 16px;
  max-width: 1400px;
  margin: 0 auto;
}
.panel-col {
  background: linear-gradient(
    180deg,
    rgba(255, 255, 255, 0.04),
    rgba(255, 255, 255, 0.02)
  );
  border: 1px solid rgba(255, 255, 255, 0.08);
  border-radius: 12px;
  padding: 12px;
  flex: 1 1 320px;
  min-width: 280px;
}
.panel-title {
  margin: 0 0 8px 0;
  font-size: 14px;
  color: #dbeafe;
}
.muted {
  color: var(--muted);
  font-size: 12px;
}

.lib {
  list-style: none;
  margin: 0;
  padding: 0;
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}
.lib-item {
  padding: 10px 12px;
  border: 1px dashed rgba(255, 255, 255, 0.25);
  border-radius: 10px;
  cursor: grab;
  background: rgba(255, 255, 255, 0.04);
}
.lib-item:active {
  cursor: grabbing;
}

.field {
  display: flex;
  flex-direction: column;
  gap: 4px;
  font-size: 12px;
  color: var(--muted);
  max-width: 260px;
}
.field input,
.field select {
  padding: 8px;
  border-radius: 8px;
  border: 1px solid rgba(255, 255, 255, 0.1);
  background: #0d1226;
  color: var(--text);
}
.panel-buttons {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}
button {
  appearance: none;
  border: none;
  padding: 8px 12px;
  border-radius: 10px;
  background: var(--accent);
  color: white;
  font-weight: 600;
  cursor: pointer;
}
button.ghost {
  background: transparent;
  border: 1px solid rgba(255, 255, 255, 0.14);
  color: var(--muted);
}
button.primary {
  background: var(--accent);
}

/* Wrapper: griglia pieno schermo (meno header + pannello) */
.wrap {
  padding: 16px;
  max-width: 1400px;
  margin: 0 auto;
  min-height: calc(100vh - 60px); /* header ~60px */
  display: block;
}

/* Griglia */
.grid {
  display: grid;
  gap: var(--grid-gap);
  height: calc(
    100vh - 60px - var(--panel-open-h, 0px) - 32px
  ); /* 32px circa padding wrap */
  /* sopra uso una var per sottrarre l'altezza del pannello quando è aperto (vedi JS) */
}
.cell {
  background: linear-gradient(
    180deg,
    rgba(255, 255, 255, 0.04),
    rgba(255, 255, 255, 0.02)
  );
  border: 1px solid rgba(255, 255, 255, 0.06);
  border-radius: 14px;
  position: relative;
  overflow: hidden;
  min-height: 140px;
}
/* Tratteggi/placeholder solo in Modifica */
.editing .cell {
  border: 1px dashed rgba(255, 255, 255, 0.18);
}
.cell.drop-target {
  outline: 2px dashed var(--accent);
}
.cell .placeholder {
  display: none;
  opacity: 0.6;
  align-items: center;
  justify-content: center;
  height: 100%;
}
.editing .cell .placeholder {
  display: flex;
}

/* Widget */
.widget {
  height: 100%;
  padding: 10px;
}
.widget .title {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 13px;
  color: var(--muted);
}
.widget .body {
  margin-top: 6px;
}
.badge {
  font-size: 11px;
  color: #dbeafe;
  border: 1px solid rgba(255, 255, 255, 0.18);
  padding: 2px 6px;
  border-radius: 999px;
}
.handle {
  cursor: grab;
}

.clock .time {
  font-variant-numeric: tabular-nums;
  font-size: 40px;
  font-weight: 800;
  letter-spacing: 1px;
}
.clock .date {
  color: var(--muted);
}

.weather .temp {
  font-size: 34px;
  font-weight: 800;
}
.weather .meta {
  color: var(--muted);
  font-size: 12px;
}

/* Footer */
.footer {
  display: flex;
  justify-content: center;
  padding: 12px;
  color: var(--muted);
}

/* Il widget diventa un contenitore posizionato per il tasto elimina */
.widget {
  height: 100%;
  padding: 10px;
  position: relative;
}

/* Tasto elimina: visibile solo in modalità modifica */
.widget .delete-btn {
  position: absolute;
  bottom: 9px;
  right: 8px;
  display: none;
  align-items: center;
  gap: 6px;
  padding: 6px 8px;
  border-radius: 8px;
  background: rgba(239, 68, 68, 0.12);
  color: #fecaca;
  border: 1px solid rgba(239, 68, 68, 0.35);
  font-size: 12px;
  cursor: pointer;
}
.editing .widget .delete-btn {
  display: inline-flex;
}
.widget .delete-btn:hover {
  filter: brightness(1.1);
}

.tasklist .task-form {
  display: flex;
  gap: 8px;
  margin-bottom: 8px;
}
.tasklist .task-input {
  flex: 1;
  padding: 8px;
  border-radius: 8px;
  border: 1px solid rgba(255, 255, 255, 0.1);
  background: #0d1226;
  color: var(--text);
}
.tasklist .task-list {
  list-style: none;
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: column;
  gap: 6px;
  max-height: 200px;
  overflow: auto;
}
.tasklist .task-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  padding: 6px 8px;
  border: 1px solid rgba(255, 255, 255, 0.06);
  border-radius: 8px;
  background: rgba(255, 255, 255, 0.03);
}
.tasklist .task-row {
  display: flex;
  gap: 8px;
  align-items: center;
}
.tasklist .task-text.done {
  text-decoration: line-through;
  opacity: 0.7;
}
.tasklist .task-actions {
  display: flex;
  gap: 8px;
  margin-top: 8px;
}
.tasklist .tiny {
  padding: 4px 6px;
  font-size: 12px;
  border-radius: 6px;
}


.weather-body{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px}
.weather-body .main-info{display:flex;align-items:center;gap:12px}
.weather-body .temp{font-size:clamp(24px,5vw,48px);font-weight:700}
.weather-body .icon{width:64px;height:64px}


/* Player */
.player .player-body{display:flex;flex-direction:column;gap:10px}
.player .cover{display:flex;justify-content:center;align-items:center}
.player .disc{
  width:72px;height:72px;border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  background:radial-gradient(circle at 30% 30%, rgba(255,255,255,.2), rgba(255,255,255,.05));
  border:1px solid rgba(255,255,255,.1);
  box-shadow:0 6px 24px rgba(0,0,0,.25);
  font-size:28px;
}
.player .disc.spin{ animation: spin 5s linear infinite }
@keyframes spin{ from{transform:rotate(0)} to{transform:rotate(360deg)} }

.player .meta{text-align:center}
.player .track-title{font-weight:700}
.player .track-sub{font-size:12px;color:var(--muted)}

.player .controls{display:flex;justify-content:center;align-items:center;gap:8px}
.player .btn{
  appearance:none;border:none;border-radius:10px;padding:8px 12px;
  background:rgba(255,255,255,.08);color:var(--text);cursor:pointer;font-weight:700
}
.player .btn.tiny{padding:6px 8px;font-size:12px}
.player .btn.active{outline:2px solid var(--accent)}
.player .btn.play{font-size:18px;padding:8px 14px}

.player .progress{display:flex;align-items:center;gap:8px}
.player .time{font-variant-numeric:tabular-nums;font-size:12px;color:var(--muted)}
.player .bar{flex:1;height:8px;border-radius:999px;background:rgba(255,255,255,.08);position:relative;cursor:pointer}
.player .fill{position:absolute;inset:0 0 0 0;width:0%;background:linear-gradient(90deg,var(--accent),#06b6d4);border-radius:999px}

.player .volume{display:flex;align-items:center;gap:8px}
.player .volume .vol{width:100%}
.player .playlist{
  list-style:none;margin:0;padding:0;max-height:140px;overflow:auto;
  display:flex;flex-direction:column;gap:6px
}
.player .playlist li{
  padding:6px 8px;border-radius:8px;background:rgba(255,255,255,.04);
  border:1px solid rgba(255,255,255,.06);cursor:pointer;font-size:13px
}
.player .playlist li.active{outline:2px solid var(--accent)}
